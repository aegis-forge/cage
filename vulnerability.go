package cage

import (
	"strings"
	"time"
)

type Vulnerability struct {
	cve              string
	cwes             []string
	cvss             float32
	published        time.Time
	rangesVulnerable []VersionRange
	rangesPatched    []VersionRange
}

func NewVulnerability(cve string, cwes []string, cvss float32,
	published string, rangesVulnerable, rangesPatched []VersionRange, 
	timeFormat string) (*Vulnerability, error) {

	if timeFormat == "" {
		timeFormat = "2006-01-02 15:04:05 -0700"
	}

	timeFormatted, err := time.Parse(timeFormat, strings.TrimSpace(published))

	if err != nil {
		return nil, err
	}

	return &Vulnerability{
		cve: cve, cwes: cwes, cvss: cvss, published: timeFormatted, 
		rangesVulnerable: rangesVulnerable, rangesPatched: rangesPatched,
	}, nil
}
