package cage

import (
	"testing"
)

// ==========================
// ==== NewVulnerability ====
// ==========================

func TestNewVulnerabilityValid(t *testing.T) {
	semver, _ := NewSemver("1.0")
	published := "2025-07-25T17:51:51Z"
	semverRange, _ := NewVersionRange(semver, semver, true, true)
	semverRanges := []VersionRange{*semverRange}

	if _, err := NewVulnerability("a", []string{"b"}, 1.2, published,
		semverRanges, semverRanges, "2006-01-02T15:04:05Z"); err != nil {

		t.Error("vulnerability should be valid")
	}
}

func TestNewVulnerabilityInvalid(t *testing.T) {
	semver, _ := NewSemver("1.0")
	published := "2025-07T17:51:51Z"
	semverRange, _ := NewVersionRange(semver, semver, true, true)
	semverRanges := []VersionRange{*semverRange}

	if _, err := NewVulnerability("a", []string{"b"}, 1.2, published,
		semverRanges, semverRanges, "2006-01-02T15:04:05Z"); err == nil {

		t.Error("vulnerability should not be valid")
	}
}
